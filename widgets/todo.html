<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>待办</title>
    <style>
        :root {
            --primary: #007aff;
            /* iOS Blue */
            --bg: #ffffff;
            --text: #000000;
            --secondary-text: #8e8e93;
            --separator: #c6c6c8;
            --danger: #ff3b30;
            --circle-border: #d1d1d6;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --primary: #0a84ff;
                --bg: #1c1c1e;
                --text: #ffffff;
                --secondary-text: #98989d;
                --separator: #38383a;
                --circle-border: #545458;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, "SF Pro Text", "Helvetica Neue", sans-serif;
            background: var(--bg);
            color: var(--text);
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            user-select: none;
        }

        /* --- Header (Dynamic) --- */
        header {
            padding: 3vmin 4vmin 1vmin;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            min-height: 12vmin;
        }

        h1 {
            font-size: 8vmin;
            /* Huge Title */
            font-weight: 700;
            letter-spacing: -0.02em;
            color: var(--primary);
            line-height: 1;
        }

        .count {
            font-size: 8vmin;
            font-weight: 700;
            color: var(--secondary-text);
        }

        /* --- List --- */
        ul {
            flex: 1;
            overflow-y: auto;
            list-style: none;
            padding: 0 0 15vmin;
            /* Padding for bottom bar */
        }

        /* Hide scrollbar */
        ul::-webkit-scrollbar {
            display: none;
        }

        li {
            display: flex;
            align-items: flex-start;
            /* Top align for multiline */
            padding: 2.5vmin 4vmin;
            gap: 3vmin;
            transition: all 0.2s;
        }

        li:active {
            background: rgba(128, 128, 128, 0.1);
        }

        .check-circle {
            width: 6vmin;
            height: 6vmin;
            /* Large tap target */
            border: 2px solid var(--circle-border);
            border-radius: 50%;
            flex-shrink: 0;
            margin-top: 0.5vmin;
            transition: all 0.2s;
        }

        li.done .check-circle {
            background: var(--primary);
            border-color: var(--primary);
            position: relative;
        }

        li.done .check-circle::after {
            content: '';
            position: absolute;
            top: 45%;
            left: 50%;
            width: 35%;
            height: 20%;
            border-left: 2px solid white;
            border-bottom: 2px solid white;
            transform: translate(-50%, -60%) rotate(-45deg);
        }

        .text {
            font-size: 5vmin;
            font-weight: 500;
            line-height: 1.3;
            padding-bottom: 2vmin;
            border-bottom: 1px solid var(--separator);
            width: 100%;
        }

        li:last-child .text {
            border: none;
        }

        li.done .text {
            color: var(--secondary-text);
            text-decoration: none;
            /* iOS doesn't strike through usually, just dims. But explicit is better? */
            opacity: 0.6;
        }

        /* --- Bottom Bar with Add Button --- */
        .bottom-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 14vmin;
            background: rgba(255, 255, 255, 0.0);
            /* Transparent gradient? */
            background: linear-gradient(to top, var(--bg) 80%, transparent);
            display: flex;
            align-items: center;
            padding: 0 4vmin;
        }

        .add-btn {
            display: flex;
            align-items: center;
            font-size: 5vmin;
            font-weight: 600;
            color: var(--primary);
            cursor: pointer;
            gap: 2vmin;
            width: 100%;
            height: 100%;
        }

        .plus-icon {
            font-size: 7vmin;
            font-weight: 300;
            padding-bottom: 0.5vmin;
        }

        /* --- Empty State --- */
        .empty {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 60%;
            color: var(--secondary-text);
            text-align: center;
        }

        .empty-icon {
            font-size: 10vmin;
            margin-bottom: 2vmin;
            opacity: 0.5;
        }

        /* --- Input Modal (Full Cover) --- */
        .modal {
            position: fixed;
            inset: 0;
            background: var(--bg);
            z-index: 100;
            display: flex;
            flex-direction: column;
            padding: 4vmin;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .modal.open {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4vmin;
        }

        .cancel-btn,
        .done-btn {
            font-size: 4.5vmin;
            font-weight: 400;
            color: var(--primary);
            border: none;
            background: none;
            cursor: pointer;
        }

        .done-btn {
            font-weight: 600;
        }

        textarea {
            flex: 1;
            border: none;
            background: transparent;
            font-size: 6vmin;
            font-family: inherit;
            color: var(--text);
            resize: none;
            outline: none;
        }

        /* --- Layout: 1x1 Compact Mode Modifications --- */
        /* If window is very small (<180px), simplify heavily */
        @media (max-width: 180px) and (max-height: 180px) {
            h1 {
                font-size: 15vmin;
            }

            /* Huge Counter */
            header {
                padding: 2vmin 3vmin 0;
                min-height: auto;
                align-items: flex-start;
                flex-direction: column;
            }

            .count {
                display: none;
            }

            /* h1 is now the count or Title */

            /* In 1x1, maybe we just show the top few items and hide bottom bar? */
            /* Actually, user wants "Full Function". */
            /* Let's make the list font even bigger for 1x1 readability */
            .text {
                font-size: 8vmin;
                padding-bottom: 1vmin;
            }

            .check-circle {
                width: 8vmin;
                height: 8vmin;
            }

            /* Floating Add button instead of bar for space */
            .bottom-bar {
                display: none;
            }

            .fab-add {
                position: absolute;
                bottom: 2vmin;
                right: 2vmin;
                width: 12vmin;
                height: 12vmin;
                background: var(--primary);
                border-radius: 50%;
                color: white;
                font-size: 10vmin;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            }
        }
    </style>
</head>

<body>
    <header>
        <h1 id="listTitle">提醒</h1>
        <div class="count" id="listCount">0</div>
    </header>

    <div class="empty" id="emptyState">
        <div class="empty-icon">✓</div>
        <div style="font-size: 4vmin">无待办事项</div>
    </div>

    <ul id="list">
        <!-- Rendered JS -->
    </ul>

    <!-- Standard Footer Add -->
    <div class="bottom-bar" id="barAdd">
        <div class="add-btn">
            <span class="plus-icon">+</span> 新提醒
        </div>
    </div>

    <!-- 1x1 FAB Add (Hidden by default CSS, shown via JS logic or media query) -->
    <div class="fab-add" id="fabAdd" style="display:none">+</div>

    <!-- Input Modal -->
    <div class="modal" id="modal">
        <div class="modal-header">
            <button class="cancel-btn" id="btnCancel">取消</button>
            <button class="done-btn" id="btnAdd">添加</button>
        </div>
        <textarea id="input" placeholder="标题" autofocus></textarea>
    </div>

    <script>
        const STORAGE_KEY = 'todo_premium';
        let items = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

        // Dom
        const elList = document.getElementById('list');
        const elCount = document.getElementById('listCount');
        const elEmpty = document.getElementById('emptyState');
        const elModal = document.getElementById('modal');
        const elInput = document.getElementById('input');

        function init() {
            render();
            checkLayout();
            window.addEventListener('resize', checkLayout);

            // Events
            document.getElementById('barAdd').onclick = openModal;
            document.getElementById('fabAdd').onclick = openModal;
            document.getElementById('btnCancel').onclick = closeModal;
            document.getElementById('btnAdd').onclick = addItem;
        }

        function checkLayout() {
            const isSmall = window.innerWidth < 180;
            document.getElementById('barAdd').style.display = isSmall ? 'none' : 'flex';
            document.getElementById('fabAdd').style.display = isSmall ? 'flex' : 'none';

            // 1x1: Title becomes just "Reminders"

            // Re-render to adjust font classes if we wanted, but CSS Media Query handles mostly
        }

        function save() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
            render();
        }

        function render() {
            elList.innerHTML = '';

            const active = items.filter(i => !i.done);
            const done = items.filter(i => i.done);

            // Sort: Active first
            const displayList = [...active, ...done];

            elCount.textContent = active.length;

            if (items.length === 0) {
                elEmpty.style.display = 'flex';
                elList.style.display = 'none';
            } else {
                elEmpty.style.display = 'none';
                elList.style.display = 'block';

                displayList.forEach(item => {
                    const li = document.createElement('li');
                    if (item.done) li.classList.add('done');

                    li.innerHTML = `
                        <div class="check-circle" onclick="toggle('${item.id}')"></div>
                        <div class="text" onclick="edit('${item.id}')">${item.text}</div>
                    `;
                    elList.appendChild(li);
                });
            }
        }

        // Actions
        window.toggle = (id) => {
            const it = items.find(i => i.id === id);
            if (it) it.done = !it.done;
            save();
        };

        window.edit = (id) => {
            // Optional: Edit existing? For simplicity, we just toggle or delete
            // Let's implement Delete on long press or similar? 
            // Interactive standard: just click text to edit?
        };

        function openModal() {
            elModal.classList.add('open');
            setTimeout(() => elInput.focus(), 300);
        }

        function closeModal() {
            elModal.classList.remove('open');
            elInput.value = '';
        }

        function addItem() {
            const val = elInput.value.trim();
            if (val) {
                items.unshift({
                    id: Date.now().toString(),
                    text: val,
                    done: false
                });
                save();
            }
            closeModal();
        }

        // Right click delete
        elList.oncontextmenu = (e) => {
            e.preventDefault();
            // In a real app we'd find the item under cursor.
            // Here, we just rely on "Clear Completed"?
            // Let's add simple "Clear Completed" button in Title long press?
        };

        init();
    </script>
</body>

</html>